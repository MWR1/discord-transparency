(()=>{"use strict";const e="__BACKGROUND-IMAGE__",t="__BRIGHTNESS__",n="__BLUR__",r="TRANSPARENCY",o=`${r}__ACTIONS-PANEL`,a=`${o}-OVERLAY`,l=`${r}__ACTIONS_PANEL`,i=`${r}__ALERTS-STYLESHEET`,s=`${r}__IMAGE-INPUT-PICKER`,c=`${r}__SET-BACKGROUND`,d="theme-dark",u="theme-light",m=`${r}__ALERT`,p=`${m}--INACTIVE`,g=`${o}--SLIDE-IN`,b=`${r}__ACTION`,h=`${b}--ACTIVE`,f=`${b}-WARNING`,_=`${b}-INPUT`,v=`${b}__INPUT-PICKER`,y=`${b}-LEVEL-INDICATOR`,$=`${b}-SAVE-LEVEL`,w=new Map,x=new Map,k=new Map;function T(e){const t=w.get("mainStyleSheet"),n=w.get("titleBarElement");if(!t.hasAttribute("media"))return t.setAttribute("media","1px"),null!==n&&(n.style.backgroundColor="var(--color-tertiary)"),void(e.style.display="none");const r=k.get("isDarkTheme"),o=k.get("brightness");t.removeAttribute("media"),null!==n&&(n.style.backgroundColor=r?`rgba(0,0,0,0.${o}`:`rgba(255,255,255,0.${o}`),e.classList.contains(g)&&(e.style.display="block")}const E="Press here to browse for an image on your computer",N="Set as background image ðŸŒŸ";function S(e){return`ðŸ›‘ Oh no, there's been an error. If you see this, join the support server, and report the error. [[${e}]]`}const L=`.${b} {\n  min-height: 100px;\n  background-color: rgba(0, 0, 0, 0.5);\n  margin: 10px;\n  color: white;\n  cursor: pointer;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  padding: 30px 50px;\n  transition: background-color 300ms linear;\n}\n\n.${h} {\n  background-color: rgba(0, 0, 0, 0.8);\n  cursor: initial;\n}\n\n.${_} {\n  box-sizing: border-box;\n  text-align: center;\n  padding: 15px 0;\n  width: 100%;\n  border: 0;\n  background-color: rgba(255, 255, 255, 0.1);\n  border-radius: 50px;\n  color: white;\n}\n\n.${v} {\n  padding: 20px 15px !important;\n  cursor: pointer;\n  font-family: var(--font-primary);\n  font-size: smaller;\n}\n\n.${_}:focus,\n.${$}:focus {\n  outline: none;\n  border: 2px solid dodgerblue;\n}\n\n.${y} {\n  margin: 0;\n  opacity: 0.8;\n  text-align: center;\n}\n\n.${f} {\n  display: none;\n  font-size: 11px;\n  line-height: 20px;\n  color: white;\n  max-width: 310px;\n  margin: 20px 0 0;\n  opacity: 0.8;\n}\n\n.${_}:focus ~ .${f} {\n  display: block;\n}\n\n.${$} {\n  height: 40px;\n  padding: 0 15px;\n  max-width: 300px;\n  margin-top: 10px;\n  border: 0;\n  background-color: rgba(255, 255, 255, 0.1);\n  border-radius: 50px;\n  color: white;\n  cursor: pointer;\n}\n\n#${c} {\n  position: absolute;\n  left: -100%;\n  bottom: 0;\n  width: max-content;\n  padding: 10px;\n  margin-left: -15px;\n  background-color: inherit;\n  border-radius: inherit;\n  font-size: 14px;\n  cursor: pointer;\n}`,C=`.${m} { \n  position: absolute;\n  left: 0px;\n  right: 0px;\n  margin: auto;\n  padding: 20px;\n  font-size: 14px;\n  width: fit-content;\n  width: -moz-fit-content;\n  max-width: 450px;\n  background-color: rgba(0,0,0,0.6);\n  backdrop-filter: blur(8px);\n  color: white;\n  border-bottom-right-radius: 20px;\n  border-bottom-left-radius: 20px;\n  z-index: 10000;\n  box-shadow: 0px 13px 10px -5px rgba(0,0,0,0.5);\n  transition: transform 500ms ease;\n  animation: TRANSPARENCY__ALERT-SLIDE 500ms ease;\n  overflow: hidden;\n}\n\n.${m}::after {\n    content: "";\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    background-color: hsl(235 100% 82% / 1);\n    width: 100%;\n    height: 5px;\n    animation: TRANSPARENCY__ALERT-TIMER-BAR linear forwards;\n    animation-duration: var(--timer-bar-timeout);\n}\n\n@keyframes TRANSPARENCY__ALERT-TIMER-BAR {\n  from {\n    transform: translateX(-100%);\n  } to {\n    transform: translateX(0); \n  }\n}\n\n@keyframes TRANSPARENCY__ALERT-SLIDE {\n  from { transform: translateY(-130%); }\n  to { transform: translateY(0) }\n}\n\n.${p} {\n  transform: translateY(-130%);\n}`,R=".typeWindows_a934d8.withFrame_a934d8.titleBar_a934d8,  .typeWindows_a934d8.withFrame_a934d8.titleBar_a934d8.withBackgroundOverride_a934d8",P=".app_bd26cc",A=".layerContainer_cd0de5",I=".toast_f42767",B=".browser_f542fc",M=".messagesPopoutWrap_ac90a2",D=".recentMentionsPopout_ddb5b4",O=".quickswitcher_f4e139",H=".container_f24a96",K=".popout_f6639d",Y=".main_e3f8c2",V=".streamPreview_adbea6",W=".popout_a9414b",U=".applicationStore_cecc86",z=".container-3wLKDe",F=".themed-Hp1KC_",G=".directoryContainer_da3f59",q=".header_f1fd9c, .container_e44302, .chat_a7d72e, .scrollerContainer_c6b11b",j=".pageWrapper_a3a4ce",X=".searchResultsWrap_c2b47d",J=".themeEditor_c9dda6",Q=".editor_bcfa1e",Z=".container_d1c246",ee=".wrapper_f9f2ca",te=".blockedSystemMessage_c09d0f",ne=".embedFull_b0068a",re=".wrapper_a71a1c",oe=".code.inline, .markup-2BOw-j code, code",ae=".attachment_b52bef",le=".wrapperAudio_f72aac",ie=".wrapper_ef319f",se=".container_e40c16",ce=".reaction_ec6b19",de=".hoverButtonGroup_ab8b23",ue=".userProfileInnerThemedNonPremium_c69a7b",me=".container_ac201b",pe=".contentWrapper_af5dbb",ge=".wrapper_c6ee36",be=".container_f2bfbb, .reactors_f2bfbb",he=".wrapper_e06857",fe=".wrapper_c43059",_e=".premiumPromo_ca9b56",ve=".header_bd05f1",ye=".previewContainer_da1bd9";function $e(){const e=k.get("brightness"),t=k.get("isDarkTheme"),n=t?`rgba(0, 0, 0, 0.${e})`||"rgba(0,0,0,0.9)":`rgba(255, 255, 255, 0.${e})`||"rgba(255,255,255,0.7)",r=t?"rgba(0,0,0,0.78)":"rgba(255,255,255,0.85)",l=t?"rgba(0,0,0,0.92)":"rgba(255,255,255,0.95)";return`.theme-dark, .theme-light {\n  --background-primary: transparent !important;\n  --background-secondary: transparent !important;\n  --background-tertiary: transparent !important;\n  --channeltextarea-background: transparent !important;\n  --deprecated-panel-background: transparent !important;\n  --background-secondary-alt: transparent !important;\n  --scrollbar-auto-track: transparent !important;\n  --home-background: transparent !important;\n  --card-secondary-bg: ${(i={backgroundImageURL:k.get("backgroundImageURL"),blurLevelPixels:`${k.get("blur")}px`,brightnessLevelRGBA:n,variousElementsBackground:r,variousElementsBackgroundMoreOpaque:l}).variousElementsBackground} !important;\n}\n\n.theme-dark {\n  --scrollbar-auto-thumb:rgba(255,255,255,0.3) !important;\n  --profile-body-background-color: rgba(255, 255, 255, 0.1) !important;   \n}\n\n.theme-light {\n  --scrollbar-auto-thumb:rgba(0,0,0,0.6) !important;\n  --profile-body-background-color: rgba(0, 0, 0, 0.05) !important;\n}\n\n#app-mount {\n  background: url(${i.backgroundImageURL}) center center no-repeat;\n  background-size: cover;\n}\n\n${R} {\n  margin-top: 0;\n  padding-top: 4px;\n  background: ${i.brightnessLevelRGBA};\n  backdrop-filter: blur(${i.blurLevelPixels})\n}\n\n${P}, ${J}, ${Q} {\n  background-color: ${i.brightnessLevelRGBA};\n  backdrop-filter: blur(${i.blurLevelPixels});\n} \n\n${U}, ${z}, \n${G}, ${q}, ${j},\n${F} {\n  background-color: transparent !important;\n}\n\n${me}, ${le}, \n${ie}, ${X}, ${pe},\n${se}, ${ce},\n${ne}, ${ae},\n${be}, ${re}, ${oe},\n${ve}, ${Q}, ${Z}, \n${H}, ${K}, ${W},\n${V} {\n  background-color: ${i.variousElementsBackground} !important;\n}\n\n${ue}, ${Y}, ${D},\n${ge}, ${he},\n${O}, ${M}, ${B}, \n${I}, ${pe}, ${fe},\n${de}, ${_e} {\nbackground-color: ${i.variousElementsBackgroundMoreOpaque} !important;\n}\n\n${ye} {\n  align-items: center;\n}\n\n${ve} {\n  margin-left: -24px;\n  padding-left: 24px;\n}\n\n${ee}:has(${te}) {\n  display: none;\n}\n\n#${o} {\n  font-family: "Whitney", "Helvetica Neue", "Helvetica", monospace, "Arial", sans-serif;\n  width: 30%;\n  height: 100%;\n  background-color: rgba(0,0,0,0.6);\n  position: absolute;\n  right: 0;\n  z-index: 200;\n  backdrop-filter: blur(8px);\n  transform: translateX(100%);\n  transition: transform 500ms ease;\n}\n\n#${a} {\n  display: none;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 199;\n}\n\n.${g} {\n  transform: translateX(0) !important;\n}\n`;var i}function we(t){w.get("mainStyleSheet").innerHTML+=function(e){return`#app-mount{background: url(${e}) center center no-repeat !important; background-size: cover !important;}`}(t),k.set("backgroundImageURL",t),window.localStorage.setItem(e,t)}function xe({elementName:e,appendTo:t,htmlProps:n}){const r=document.createElement(e);for(const[e,t]of Object.entries(n))r[e]=t;if(void 0!==n.style)for(const[e,t]of Object.entries(n.style))r.style[e]=t;return t.appendChild(r),r}function ke({text:e,timeout:t,containsHTML:n=!1}){const r=xe({elementName:"div",appendTo:document.body,htmlProps:{className:m,[n?"innerHTML":"textContent"]:e}});return r.style.setProperty("--timer-bar-timeout",`${t}ms`),new Promise((e=>{setTimeout((()=>{r.classList.add(p),setTimeout((()=>{r.remove(),e(!0)}),1e3)}),t)}))}function Te(){const e=k.get("blur");window.localStorage.setItem(n,e.toString()),ke({text:`Blur level updated! Now it is at level <b>${e}</b>.`,containsHTML:!0,timeout:3e3})}function Ee(){const e=k.get("brightness");window.localStorage.setItem(t,e.toString()),ke({text:`Brightness level updated! Now it is at level <b>${e}</b>.`,containsHTML:!0,timeout:3e3})}const Ne=[{name:"Change the background image",execute(e){const t=xe({elementName:"label",appendTo:e,htmlProps:{className:`${_} ${v}`,htmlFor:s,textContent:E}}),n=xe({elementName:"input",appendTo:e,htmlProps:{type:"file",id:s,accept:"image/*",style:{display:"none"}}});xe({elementName:"p",appendTo:e,htmlProps:{textContent:"- or -"}});const r=xe({elementName:"input",appendTo:e,htmlProps:{className:_,placeholder:"Paste image link here"}});xe({elementName:"p",appendTo:e,htmlProps:{className:f,textContent:"ðŸ›‘ The image you want as your background must be sent as a message on Discord. You will have to click on the image, press on <Open original>, and copy the link from there. After that, click on this input and press ENTER."}}),n.onchange=()=>function(e,t){if(null===e.files||0===e.files.length)return;const n=e.files[0],r=new FileReader;r.readAsDataURL(n),r.addEventListener("loadstart",(()=>{t.textContent="Loading image..."})),r.addEventListener("loadend",(()=>{const e=r.result;if(null===e)return void ke({text:S("image data could not be read"),timeout:1e4});we(e);const o=n.name.split(".")[1]||"???",a=n.name.length>25?`(${n.name.slice(0,25)}...).${o}`:n.name;t.innerHTML=null!==n?`${E} | Image name: ${n.name.length>25?`<span title="${n.name}" style="text-decoration: underline; cursor: help">${a}</span>`:n.name}`:E})),r.addEventListener("error",(e=>ke({text:S(`image reader gave error${e.lengthComputable?`, only ${(e.loaded/e.total*100).toPrecision(2)}% of image loaded`:""}}`),timeout:1e4})))}(n,t),r.onkeydown=e=>{const o=r.value.trim();"Enter"===e.code&&""!==o&&(t.textContent=E,n.value="",we(o))}}},{name:"Change the brightness level",execute(e){const t=k.get("isDarkTheme")?"0,0,0":"255,255,255",n=k.get("brightness"),r=xe({elementName:"h3",appendTo:e,htmlProps:{className:y,textContent:`Brightness level: ${n}`}}),o=xe({elementName:"input",appendTo:e,htmlProps:{className:_,type:"range",min:"0",max:"9",value:n.toString(),oninput:()=>function({overlayColor:e,brightnessLevelIndicator:t,brightnessLevelSlider:n}){const r=w.get("overlayDarkenerElement"),o=w.get("titleBarElement");r.style.backgroundColor=`rgba(${e}, .${n.value})`,null!==o&&(o.style.backgroundColor=`rgba(${e}, .${n.value})`),t.textContent=`Brightness level: ${n.value}`,k.set("brightness",parseInt(n.value))}({overlayColor:t,brightnessLevelIndicator:r,brightnessLevelSlider:o})}});xe({elementName:"button",appendTo:e,htmlProps:{className:$,textContent:"Save brightness level",onclick:Ee}})}},{name:"Change the blur level",execute(e){const t=k.get("blur"),n=xe({elementName:"h3",appendTo:e,htmlProps:{className:y,textContent:`Blur level: ${t}`}}),r=xe({elementName:"input",appendTo:e,htmlProps:{className:_,type:"range",min:"0",max:"50",value:t.toString(),oninput:()=>function(e,t){const n=w.get("overlayDarkenerElement"),r=w.get("titleBarElement");n.style.backdropFilter=`blur(${t.value}px)`,null!==r&&(r.style.backdropFilter=`blur(${t.value}px)`),e.textContent=`Blur level: ${t.value}`,k.set("blur",parseInt(t.value))}(n,r)}});xe({elementName:"button",appendTo:e,htmlProps:{className:$,textContent:"Save blur level",onclick:Te}})}}];function Se(e,t){t.classList.add(h),t.textContent="";try{t.onclick=null,e.execute(t)}catch(e){alert(S(e.message))}}class Le{constructor(e){this.targetElement=e,this._observer=new MutationObserver(((e,t)=>{if(null===this._callback)throw new ReferenceError("No callback has been supplied on trigger.");for(const n of e){const e=n.target;if("childList"!==n.type||!e.classList.contains(A.slice(1))||null===e.firstChild)return;this._callback(n,t)}}))}onTrigger(e){return e&&(this._callback=e),this}observe(e){return this._observer.observe(this.targetElement,e),this}unobserve(){return this._observer.disconnect(),this}}let Ce;function Re(e){if(clearTimeout(Ce),null===e.target)return;const t=e.target;if("A"!==t.nodeName||!t.hasAttribute("href")||!t.href.includes("cdn.discord"))return;let n=null;const r=new Le(document.body);try{r.onTrigger((e=>{const o=e.target;if(n=o.querySelector(".menu_d90b3d"),null===n||"menu"!==n.role)return ke({text:"Default menu element not found. Searching manually...",timeout:3e3}),r.unobserve(),void x.delete("contextMenuCreationObserver");Pe(n,t),clearTimeout(Ce),r.unobserve(),x.delete("contextMenuCreationObserver")})).observe({subtree:!0,childList:!0})}catch(e){return void alert(S(e.message))}x.set("contextMenuCreationObserver",r),Ce=setTimeout((()=>{r.unobserve(),x.delete("contextMenuCreationObserver"),n=function(){const e=Array.from(document.querySelectorAll(A));if(0===e.length)return null;for(const t of e){const e=t.querySelector("div[role='menu']");if(null==e?void 0:e.className.includes("menu"))return e}return null}(),null!==n&&Pe(n,t)}),5e3)}function Pe(e,t){const n=k.get("isDarkTheme");xe({elementName:"button",appendTo:e,htmlProps:{id:c,textContent:N,style:{color:n?"gold":"#7c7300",boxShadow:"0px 0px 13px 0px "+(n?"hsl(51deg 100% 50% / 45%)":"hsl(51deg 100% 22% / 45%)")}}}).onclick=()=>we(t.href)}function Ae({legacyStorageKey:e,newStorageKey:t,defaultValue:n}){try{let r=window.localStorage.getItem(t);return null===r&&(r=window.localStorage.getItem(e),null===r?r=n:(window.localStorage.removeItem(e),window.localStorage.setItem(t,r))),!0}catch(e){return alert(S(e.message)),!1}}class Ie{constructor({targetElement:e,from:t,to:n}){this._callback=null,this.targetElement=e,this._from=t,this._to=n,this._wasClassNamePreviouslyPresent=!this.targetElement.classList.contains(this._from)&&this.targetElement.classList.contains(this._to),this._observer=new MutationObserver(((e,t)=>{if(null===this._callback)throw new ReferenceError("No callback has been supplied on class change.");for(const n of e){if("attributes"!==n.type||"class"!==n.attributeName)continue;const e=n.target,r=!e.classList.contains(this._from)&&e.classList.contains(this._to);r!==this._wasClassNamePreviouslyPresent&&(this._wasClassNamePreviouslyPresent=r,this._callback(n,t))}}))}onTrigger(e){return this._callback=e,this}observe(e){return this._observer.observe(this.targetElement,e),this}unobserve(){return this._observer.disconnect(),this}}function Be(){const e=document.getElementById(r),t=document.getElementById(i),n=document.getElementById(o),s=document.getElementById(a),c=document.getElementById(l);if(null==t||t.remove(),null==n||n.remove(),null==s||s.remove(),null==c||c.remove(),null!==e&&(window.onkeydown=null,e.remove()),window.__TRANSPARENCY_OBSERVERS__){for(const e of window.__TRANSPARENCY_OBSERVERS__.values())e.unobserve();window.__TRANSPARENCY_OBSERVERS__=void 0}}!function(){if(Be(),!(function(){const e=xe({elementName:"iframe",appendTo:document.body,htmlProps:{}});return e.style.display="none",null===e.contentWindow?(alert(S("Could not create the localStorage object because the iframe's contentWindow isn't defined.")),!1):(window.localStorage=e.contentWindow.localStorage,!0)}()&&Ae({legacyStorageKey:"bgImg",newStorageKey:e,defaultValue:""})&&Ae({legacyStorageKey:"brghtns",newStorageKey:t,defaultValue:"9"}))||(k.set("isDarkTheme",document.documentElement.classList.contains(d)).set("brightness",parseInt(null!==(s=window.localStorage.getItem(t))&&void 0!==s?s:"unset")||9).set("blur",parseInt(null!==(c=window.localStorage.getItem(n))&&void 0!==c?c:"unset")||0).set("backgroundImageURL",null!==(m=window.localStorage.getItem(e))&&void 0!==m?m:""),0)||!function(){const e=k.get("isDarkTheme"),t=new Ie({targetElement:document.documentElement,from:e?d:u,to:e?u:d});try{t.onTrigger((()=>{ke({text:"ðŸ›‘ It looks like the theme has changed. Discord will refresh in 5 seconds.",timeout:5e3}).then((()=>{t.unobserve(),location.reload()}))})).observe({attributes:!0,attributeFilter:["class"]})}catch(e){return alert(S(e.message)),!1}return x.set("themeChangeObserver",t),!0}()||(window.__TRANSPARENCY_OBSERVERS__=x,0)||!function(){const e=function(e){const t=document.querySelector(e);return null===t?(alert(S(`${e} is not in the DOM.`)),null):t}(P);if(null===e)return!1;const t=document.querySelector(R),n=xe({elementName:"style",appendTo:document.head,htmlProps:{id:r,innerHTML:$e()}});return w.set("titleBarElement",t).set("overlayDarkenerElement",e).set("mainStyleSheet",n),!0}())return void Be();var s,c,m;xe({elementName:"style",appendTo:document.head,htmlProps:{id:i,innerHTML:C}});const{actionsPanel:p,toggleActionsPanel:h}=function(){const e=xe({elementName:"div",appendTo:document.body,htmlProps:{id:o}}),t=xe({elementName:"div",appendTo:document.body,htmlProps:{id:a}}),n=function(e,t){const n=w.get("mainStyleSheet");let r;return function(){const o=e.classList.contains(g),a=n.hasAttribute("media");if(clearTimeout(r),!o&&!a)return e.style.display="block",t.style.display="block",void setTimeout((()=>e.classList.add(g)),20);o&&(e.classList.remove(g),t.style.display="none",r=setTimeout((()=>{e.style.display="none"}),1e3))}}(e,t);t.onclick=n,xe({elementName:"style",appendTo:document.head,htmlProps:{id:l,innerHTML:L}}),null!==w.get("titleBarElement")&&(e.style.paddingTop="20px");for(const t of Ne){const n=xe({elementName:"div",appendTo:e,htmlProps:{className:b,textContent:t.name}});n.onclick=()=>Se(t,n)}return{actionsPanel:e,toggleActionsPanel:n}}();ke({text:"Welcome! <br><br>To toggle the actions panel, press <b>CTRL + SHIFT + X</b><br>To toggle the theme, press <b>CTRL + D</b>",timeout:1e4,containsHTML:!0}).then((()=>{(function(){const e=k.get("isDarkTheme"),t=w.get("titleBarElement");if(null!==t)return!e&&t.classList.contains(d);const n=document.querySelector(".bg__7adbf");return null!==n&&!e&&n.classList.contains(d)})()&&(ke({text:"<b>ðŸ›‘ Warning</b><br><br>Your sidebar is currently dark themed.<br>For proper text visibility, disable its dark theme in Settings > Appearance.<br><br>The theme has disabled itself. After disabling the sidebar's dark theme, you can reactivate the theme by pressing <b>CTRL + D</b>. <u>No need to refresh</u>.",timeout:15e3,containsHTML:!0}),T(p))})),window.onkeydown=e=>{e.ctrlKey&&(e.shiftKey&&"KeyX"===e.code&&(e.preventDefault(),h()),"KeyD"===e.code&&(e.preventDefault(),T(p)))},window.addEventListener("contextmenu",Re,{capture:!0})}()})();